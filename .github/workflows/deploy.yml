name: Deploy Simulado (Salesforce)

# Gatilho: Roda apenas quando um PR é mergeado (push) na main
on:
  push:
    branches: [ "main" ]

# Permissões de segurança
permissions:
  contents: read

jobs:
  deploy-prd:
    name: Deploy to Production
    runs-on: ubuntu-latest
    environment: Production

    steps:
      - name: 1. Baixar Código (Checkout)
        uses: actions/checkout@v4

      - name: 2. Autenticar Pipeline-Runner
        run: echo "Autenticando conta de serviço (CI-CD-Runner)... [OK]"

      - name: 3. Simular Deploy para SAFULL (QAS)
        run: |
          echo "Iniciando deploy para ambiente de Quality Assurance..."
          echo "Baixando artefatos da branch main..."
          echo "Upload para ambiente de QAS... [OK]"
          echo "Rodando testes unitários Apex... [OK]"
          echo "Deploy em QAS concluído com sucesso."

      - name: 4. Simular Deploy para PRD (Produção)
        run: |
          echo "Iniciando deploy para ambiente de PRODUÇÃO..."
          echo "Validando pacote e dependências... [OK]"
          echo "Deploy em PRD finalizado!"